# 自动化公众号写稿系统 - 使用指南

## 为什么需要启动 Python 服务器？

你问到："为什么不能直接打开 HTML 就用？"

**简单解释**：
- **HTML 前端** = 用户的界面（按钮、输入框、显示）
- **Python 后端** = 真正的工作（调用 AI API、生成文章、上传公众号）

就像餐厅：
- 前端 = 餐厅的装修、菜单、服务员
- 后端 = 厨房、厨师、食材（这才是真正做饭的地方）

**为什么不能纯 HTML？**
因为 AI API Key（智谱/Gemini）不能暴露在网页里，否则会被别人盗用。必须在后端（Python 服务器）安全地调用。

## 快速开始

### 1. 启动服务

**方式 A：双击启动**
```
双击 start_web.bat
```

**方式 B：命令行启动**
```bash
python app.py
```

启动后会看到：
```
===========================================
Auto Article Generator - Web Interface
===========================================

Starting server...
Open your browser: http://localhost:5000
```

### 2. 打开浏览器

访问：**http://localhost:5000**

你会看到一个漂亮的界面：
- 左边：🤖 Gemini 3 Pro（深度思考）
- 右边：🧠 智谱 GLM（快速稳定）

### 3. 选择 AI 提供商

#### 智谱 GLM（推荐！当前可用）
- ✅ 配额充足
- ✅ 速度快
- ✅ 中文优秀
- ✅ **已配置，立即可用**

#### Gemini 3 Pro
- ⚠️ 配额有限（1500次/天）
- ⚠️ 当前已用完，需等待重置
- ✅ 深度思考能力强

### 4. 开始生成

1. 选择提供商（点击卡片）
2. 输入领域：例如"情感,心理,人际关系"
3. 点击"🎬 开始生成"
4. 实时查看进度和日志
5. 等待完成（约1-2分钟）

## 新增功能

### ✨ 1. 文章预览

生成完成后，点击"👁️ 预览文章"，会在弹窗中显示：
- 标题
- 格式化后的正文
- 模拟公众号的显示效果

### 📤 2. 一键上传到公众号

生成完成后，点击"📤 上传到公众号草稿箱"：
- 自动转换 Markdown 为公众号格式
- 上传到草稿箱
- 登录公众号后台即可看到

**前提条件**：
需要在 `.env` 文件中配置微信公众号信息：
```env
WECHAT_APP_ID=你的AppID
WECHAT_APP_SECRET=你的AppSecret
```

**获取方式**：
1. 登录微信公众平台：https://mp.weixin.qq.com
2. 进入「开发」->「基本配置」
3. 查看 AppID 和 AppSecret

### 💾 3. 下载文章

点击"💾 下载文章"，会下载 Markdown 文件到本地。

## 完整工作流程

```
1. 启动服务器
   python app.py
   ↓
2. 打开浏览器
   http://localhost:5000
   ↓
3. 选择智谱 GLM
   ↓
4. 输入领域
   "情感,心理"
   ↓
5. 点击"开始生成"
   ↓
6. 实时追踪
   - 进度条
   - 日志输出
   ↓
7. 生成完成
   显示：AI评分30%
   ↓
8. 预览文章
   查看内容
   ↓
9. 上传公众号
   一键发布到草稿箱
   ↓
10. 登录公众号后台
    编辑、群发
```

## 界面功能详解

### 主控制区
- **提供商选择**：点击卡片切换
- **内容领域**：输入你想写的主题
- **开始按钮**：启动生成流程

### 进度追踪
- **进度条**：显示完成百分比
- **当前步骤**：显示正在做什么
- **实时日志**：详细的执行过程

### 结果展示
- **标题**：生成的文章标题
- **AI 评分**：0-100%，越低越像人
- **提供商**：使用的 AI 模型
- **文件名**：本地保存的文件名

### 操作按钮
- **👁️ 预览文章**：在网页中查看
- **📤 上传到公众号**：发送到草稿箱
- **💾 下载文章**：保存到本地

## 常见问题

### Q: 为什么需要 Python 服务器？
A: 因为要安全地调用 AI API，不能把 API Key 放在前端。

### Q: 可以关闭服务器窗口吗？
A: 不可以，关闭服务器网页就访问不了了。

### Q: 支持批量生成吗？
A: 目前一次生成一篇，可以多次点击生成。

### Q: 上传公众号失败怎么办？
A: 检查以下几点：
1. `.env` 文件中的 AppID 和 AppSecret 是否正确
2. 微信公众号是否开启了开发者模式
3. 网络连接是否正常

### Q: 智谱和 Gemini 哪个更好？
A: 各有优势：
- **智谱**：中文好、速度快、配额多
- **Gemini**：深度思考、逻辑强

## 配置说明

### .env 文件

```env
# Gemini API（配额用完，等待重置）
GEMINI_API_KEY=你的Gemini_Key

# 智谱 API（已配置，可用）
ZHIPU_API_KEY=cee8fa0cd1c14420b289e549c3403c51.32zQtJrS8lW4GoIJ

# 微信公众号（可选，不上传草稿可不填）
WECHAT_APP_ID=wx9d2c4fd3c7f114c7
WECHAT_APP_SECRET=b07da717e4dbcad88f4927603a2b9929
```

## 技术架构

```
┌─────────────────┐
│  Web Browser    │
│  (前端界面)      │
└────────┬────────┘
         │ HTTP 请求
         ↓
┌─────────────────┐
│  Flask Server   │
│  (Python 后端)  │
└────────┬────────┘
         │
         ├────────→ 智谱 API
         │         (生成文章)
         │
         ├────────→ Gemini API
         │         (生成文章)
         │
         └────────→ 微信 API
                   (上传草稿)
```

## 总结

1. **必须启动 Python 服务器**（`python app.py`）
2. **然后在浏览器打开**（`http://localhost:5000`）
3. **选择智谱 GLM**（当前可用）
4. **生成、预览、上传**一键完成

---

**现在就开始吧！** 🚀

```bash
# 1. 启动服务
python app.py

# 2. 打开浏览器
# 访问 http://localhost:5000

# 3. 选择智谱，开始生成！
```
